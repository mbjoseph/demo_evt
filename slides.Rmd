---
title: "Spatiotemporal modeling of wildfire extremes"
author: "Max Joseph, Matthew Rossi, Megan Cattau, Adam Mahood, Nathan Mietkiewicz, Chelsea Nagy, Lise St. Denis, Jennifer Balch"
date: "June 20, 2017"
output: 
  beamer_presentation:
    colortheme: spruce
    fonttheme: structurebold
    fig_caption: false
in_header:
- \usepackage{xcolor}
- \usepackage{amssymb}
---

```{r setup, include=FALSE}
library(tidyverse)
library(rgdal)
library(kableExtra)
library(knitr)
knitr::opts_chunk$set(echo = FALSE, message = FALSE, warning = FALSE)
```

# Traditional extreme value theory

- **Block maxima**

- **Peaks over threshold**

# Traditional extreme value theory

- **Block maxima**

- **Peaks over threshold**

## Both require large $n$

```{r, results = "hide"}
source("R/00-fetch-data.R")

# Read fire data ----------------------
mtbs <- readOGR(mtbs_prefix, 'mtbs_fod_pts_20170501') %>%
  subset(!(STATE %in% c("Alaska", "Hawaii", "Puero Rico"))) %>%
  as.data.frame %>%
  filter(R_ACRES > 1000) %>%
  tbl_df
```

# Sample sizes for wildfires

Monitoring Trends in Burn Severity (MTBS) record: 

1984-2015 `r nrow(mtbs)` records

# Sample sizes for wildfires by year

```{r}
mtbs %>%
  group_by(FIRE_YEAR) %>%
  summarize(n = n()) %>%
  kable(format = "latex")
```
# Sample sizes for wildfires by year X HUC4 drainage

```{r, fig.width = 5, fig.height = 4}
mtbs %>%
  group_by(FIRE_YEAR, HUC4_NAME) %>%
  summarize(n = n()) %>%
  ggplot(aes(n)) + 
  geom_histogram() + 
  xlab("Number of fires") + 
  ylab("Frequency")
```

# How to study extremes with small $n$?

**"Metastastical extreme value theory (MEV)" (Marani & Ignaccolo 2015)**

- Number of events $n$ is *random*
- Parameters that determine the distribution of event size are *random*

**Sidenote:** MEV is a rediscovery of the Bayesian posterior predictive distribution


# Why is the MEV approach useful?

**Traditional extreme value theory**

- Assume large sample size

**Metastatistical extreme value theory**

- Allow inference even when $n$ is small

$\rightarrow$ inference at spatiotemporal scales relevant to decision-making


# Our extension of MEV

Move from the **temporal** (Marani & Ignaccolo 2015) to the **spatiotemporal** domain in the context of **wildfire extremes**


# Types of extremes to consider

- sizes of single fires
- number of fires
- total burn area in a region/state/country
- rates of change among years/across space

**Overall goal**: predict future changes in these quantities at a sufficiently fine spatiotemporal scale


# Model summary

Bayesian multivariate spatiotemporal mixed effects model

**Multivariate response**

1. Number of fires (Poisson)
2. Size of each fire (log-Normal)

**Explanatory variables**

- VPD, PDSI, precip, max temp., PET

**Spatiotemporal random effects**

- Orthogonal spatiotemporal basis functions (Bradley, Holan, & Wikle 2015)
- Avoids confounding with covariates


# 

![](fig/st-basis.pdf)


# Spatiotemporal drivers

Multivariate Adaptive Constructed Analogs (MACA) (Abatzoglou, Brown, 2011) 

Currently using MACAv2-METDATA, monthly timestep

1. VPD (?)
2. PDSI (?)
3. Total precip: 1 yr + 1 mo. sliding window ($\checkmark$) 
4. Mean daily maximum temp. ($\checkmark$) 
5. Potential evapotranspiration ($\checkmark$) 


# Other questions about MACA data

Any particular CMIP5 model(s) to use or avoid?

Are ensemble average values available?

# Thanks!
